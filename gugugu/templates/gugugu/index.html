{% extends 'base.html' %}
{% load static %}

{% block title %}
	GUGUGU
{% endblock %}

{% block head %}
	<meta name="description" content="êµ¬êµ¬êµ¬, ì«Œ ì“¸ë§›ë‚˜ëŠ” ì˜¤í”ˆì±„íŒ… ì„œë¹„ìŠ¤. PC, ëª¨ë°”ì¼ ì–´ë””ì„œë“  ì‚¬ìš© ê°€ëŠ¥í•œ ì˜¤í”ˆì±„íŒ…!">
	<link rel="stylesheet" href="{% static 'gugugu/css/index.css' %}">
	<link rel="stylesheet" href="{% static 'css/nav.css' %}">
{% endblock %}

{% block body %}
	{% include 'nav.html' %}
	<canvas id="canvas-background"> </canvas>
	<img id="logo-shadow" src="{% static 'img/logo-big-shadow.png' %}">
	<div class="position-relative text-center">
		<div class="hero-wrapper w-100 d-flex justify-content-center flex-column">
			<div class="inner-wrapper mt-auto mb-auto justify-content-center">
				<img class="index-logo d-inline-block" src="{% static 'img/logo-bubble.png' %}">
				<div class="mt-2">
					<h3 class="font-weight-bold text-white d-inline"> GUGUGU.CO</h3>
					<span class="align-top d-inline badge mr-3 badge-outline-light text-white ml-2">BETA</span>
				</div>
				<p class="text-white font-weight-thin hero-h1 m-0 mt-3 p-0">ì«Œ ì“¸ë§›ë‚˜ëŠ” ì˜¤í”ˆì±„íŒ… ì„œë¹„ìŠ¤.</p>
				<p class="text-white font-weight-thin hero-h2 m-0 mt-1 p-0">PC, ëª¨ë°”ì¼ ì–´ë””ì„œë“  ì‚¬ìš© ê°€ëŠ¥í•œ ì˜¤í”ˆì±„íŒ…!</p>
				<div class="container">
					<form id="room-form" class="row justify-content-center" method="POST">
						{% csrf_token %}
						<div id="room-url" class="mt-5 col-10 col-md-8 col-lg-6 d-flex ">
							<h2 id="room-url-prefix" class="font-weight-bold d-inline align-self-baseline mr-2">gugugu.co/</h2>
							<input id="room-url-input" name="name" required class="form-control font-weight-bold d-inline align-self-baseline" type="text" placeholder="enter-url" value="{{ room_form.name.value|default:"" }}">
						</div>
					</form>
					<button id="room-create-button" type="submit" form="hero-form" class="btn btn-lg btn-primary btn-pill mt-4 disabled">ë°© ë§Œë“¤ê¸°</button>
				</div>
			</div>
		</div>
		<div class="container">
			<div class="row justify-content-center">
				<div class="col-10 col-md-8 text-left">
					<p class="text-white hero-h3 m-0 p-0 font-weight-thin">í˜„ì¬ í™œë°œíˆ ê°œë°œ ì¤‘ì¸ ì„œë¹„ìŠ¤ì…ë‹ˆë‹¤! ì§€ê¸ˆì€ ê°œë°œì ì„¸ë¯¸ë‚˜ Q&Aì—ì„œ ì‚¬ìš©ë˜ëŠ” ê²ƒì„ íƒ€ê²Ÿìœ¼ë¡œ ì¡ê³  ìˆìŠµë‹ˆë‹¤. ì„œë¹„ìŠ¤ì— ê´€í•œ ì•„ì´ë””ì–´ í˜¹ì€ í”¼ë“œë°± ë“±ì´ ìˆìœ¼ì‹œë©´ ì•„ë˜ì— ëŒ“ê¸€ë¡œ ë‹¬ì•„ì£¼ì‹œê¸° ë°”ëë‹ˆë‹¤! ê°ì‚¬í•©ë‹ˆë‹¤!</p>
				</div>
			</div>
			<div class="row justify-content-center">
				<a href="https://github.com/itsnamgyu/gugugu">
					<button type="button" class="btn btn-pill btn-dark btn-info my-5">
						<i class="fab fa-github mr-2"></i>
						<span> https://github.com/itsnamgyu/gugugu </span>
					</button>
				</a>
			</div>
			<div class="row justify-content-center">
				<div class="col-12 col-md-10">
					<div class="card text-left">
						<form class="card-body" id="feedback-form" method="post">
							{% csrf_token %}
							<h4 class="card-title font-weight-bold mt-2">í”¼ë“œë°±ì„ ë‚¨ê²¨ìš”!</h4>
							{% for field in form %}
								{% if field.errors %}
									<div class="alert alert-danger alert-dismissible fade show" role="alert">
										<button type="button" class="close" data-dismiss="alert" aria-label="Close"> <span aria-hidden="true"> Ã—</span> </button>
										<i class="fa fa-error"></i>
										{{ field.label }}: {% for error in field.errors %}{{ error }}{% endfor %}
									</div>
								{% endif %}
							{% endfor %}
							<div class="form-group mt-4">
								<input type="text" class="form-control" name="nickname" id="form-nickname" placeholder="ë‹‰ë„¤ì„" form="feedback-form" value="{{ form.nickname.value }}">
							</div>
							<div class="form-group">
								<textarea class="form-control" id="form-content" rows="3" placeholder="ë‚´ìš©" name="content" form="feedback-form">{{ form.content.value }}</textarea>
							</div>
							<div class="w-100 text-right">
								<button type="submit" id="form-submit" form="feedback-form" class="btn btn-success" data-dismiss="modal">ì˜¬ë¦¬ê¸°</button>
								<!--
                                <button type="button" class="btn btn-outline-primary" data-toggle="modal" data-target="#modal-post">ì˜¬ë¦¬ê¸°</button>
                                <div class="modal fade" id="modal-post" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
                                    <div class="modal-dialog" role="document">
                                        <div class="modal-content">
                                            <div class="modal-header">
                                                <h5 class="modal-title" id="exampleModalLabel">ğŸ¤” ë§ˆ! ìì‹ ìˆë‚˜ìš”..?</h5>
                                                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                                                    <span aria-hidden="true">Ã—</span>
                                                </button>
                                            </div>
                                            <div class="modal-body text-left">
                                                ì•„ì§ êµ¬í˜„ì´ ì•ˆë¼ì„œ í•œë²ˆ ì˜¬ë¦¬ì‹  í”¼ë“œë°±ì€ ì‚­ì œí•  ìˆ˜ê°€ ì—†ì–´ìš”!
                                            </div>
                                            <div class="modal-footer">
                                                <button type="button" class="btn btn-secondary" data-dismiss="modal">ë‹¤ì‹œ ìƒê°í•´ë³¼ê²Œìš”...</button>
                                                <button type="submit" form="feedback-form" class="btn btn-success" data-dismiss="modal">ë¬¼ë¡ ì´ì£ !</button>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                    -->
							</div>
						</form>
					</div>
					{% for comment in comments %}
						<div class="card feedback-card text-left {% if forloop.first %}mt-5{%  else %}mt-3{% endif %} {% if forloop.last %}mb-5{% endif %}">
							<div class="card-body">
								<h5 class="card-title font-weight-bold mt-2">By {{ comment.nickname }}</h5>
								<p class="">{{ comment.content }}!</p>
							</div>
						</div>
					{%  endfor %}
				</div>
			</div>
		</div>
	</div>
{% endblock %}

{% block body_script %}
	<script src="{% static 'vendor/granim.min.js' %}"></script>
	<script src="{% static 'gugugu/js/index.js' %}"></script>

	<script>
      let input = $('#room-url-input');
      let prefix = $('#room-url-prefix');
      let button = $('#hero-button');

      function setValid(valid) {
          if (valid) {
              console.log('valid');
              input.addClass('is-valid');
              prefix.addClass('is-valid');
              button.removeClass('disabled');
          } else {
              console.log('invalid');
              input.addClass('is-invalid');
              prefix.addClass('is-invalid');
              button.addClass('disabled');
          }
      }


      {% if valid is not None %}
		      setValid("{{ valid }}" === "True");
      {% endif %}

      input.on('input', function() {
          let name = $(this).val();

          prefix.removeClass('is-valid');
          input.removeClass('is-valid');
          prefix.removeClass('is-invalid');
		      input.removeClass('is-invalid');
          button.addClass('disabled');

          if (name === '') return;

          window.clearTimeout($(this).data("timeout"));
          $(this).data("timeout", setTimeout(function () {
              $.ajax({
                  url: '{{  validate_room_name_url }}',
                  data: {
                      'name': name,
                  },
                  dataType: 'json',
                  success: function (data) {
                      setValid(data.usable);
                  }
              });
          }, 250));
      });
	</script>
{% endblock %}
